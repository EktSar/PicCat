(this["webpackJsonpskillbox-piccat"]=this["webpackJsonpskillbox-piccat"]||[]).push([[0],{106:function(e,t,n){},108:function(e,t,n){},110:function(e,t,n){},112:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(20),c=n(16),l=n(51),i=n(15),s="skillbox-piccat/auth/SET_TOKEN",u={token:null},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case s:return Object(i.a)({},e,{token:t.token});default:return e}},m=n(31),p=n(52),d=n(53),f=new(n.n(d).a)({accessKey:"eENzyfZ0gldbhV8fUtpQ1es2bwppeIGAn2acq4IAFac",secret:"_3qK4clJYpmN7YHn2i_PBykP3YNKm_qWQG5rFCBJEbI",callbackUrl:"http://localhost:3000/auth"}),k="b-6eQP7VT2lxVBqAMab-oqO01vE-hTK1jl75oYLZDOg",g=p.create({baseURL:"https://api.unsplash.com/"}),b=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return g.get("/photos/random?client_id=".concat(k,"&count=").concat(t)).then((function(e){return e.data}))},E=function(e){return g.get("/photos/".concat(e,"?client_id=").concat(k)).then((function(e){return e.data}))},_=function(e){return f.photos.likePhoto("".concat(e)).then((function(e){return 201!==e.status?{error:"\u0412\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430!"}:e.json()}))},v=function(e){return f.photos.unlikePhoto("".concat(e)).then((function(e){return 200!==e.status?{error:"\u0412\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430!"}:e.json()}))},w="skillbox-piccat/photo/SET_PHOTOS",O="skillbox-piccat/photo/SET_PHOTO",P="skillbox-piccat/photo/TOGGLE_IS_LOADING",I="skillbox-piccat/photo/LIKE_UNLIKE",y={photos:[],photosOnPageCount:10,isLoading:!0,likingInProgress:[],photoById:null},N=function(e){return{type:P,isLoading:e}},j=function(e,t){return{type:"skillbox-piccat/photo/TOGGLE_IS_LIKING_PROGRESS",isLoading:e,photoId:t}},C=function(e,t,n){return{type:I,photoId:e,liked_by_user:t,likes:n}},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return Object(i.a)({},e,{photos:[].concat(Object(m.a)(e.photos),Object(m.a)(t.photos))});case O:return Object(i.a)({},e,{photoById:t.photo});case P:return Object(i.a)({},e,{isLoading:t.isLoading});case"skillbox-piccat/photo/TOGGLE_IS_LIKING_PROGRESS":return Object(i.a)({},e,{likingInProgress:t.isLoading?[].concat(Object(m.a)(e.likingInProgress),[t.photoId]):e.likingInProgress.filter((function(e){return e!==t.photoId}))});case I:return Object(i.a)({},e,{photos:e.photos.map((function(e){return e.id===t.photoId?Object(i.a)({},e,{liked_by_user:t.liked_by_user,likes:t.likes}):e})),photoById:Object(i.a)({},e.photoById,{liked_by_user:t.liked_by_user,likes:t.likes})});default:return e}},S=Object(c.c)({auth:h,photo:x}),L=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||c.d,B=Object(c.e)(S,L(Object(c.a)(l.a))),T=n(29),G=n(12),U=n.n(G);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var R=n(19),K=n(4),M=n(34),z=n.n(M),q=n(55),A=function(){var e=Object(q.a)(z.a.mark((function e(t,n){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.auth.userAuthentication(t).then((function(e){return 403===e.status?{error:"Rate Limit Exceeded"}:e.json()})).then((function(e){var t=e.access_token;return console.log(e),t?(f.auth.setBearerToken(t),localStorage.setItem("userData",JSON.stringify({token:t})),n(t),t):null}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),D=n(114),J=n(24),H=n.n(J),V=function(e){var t=e.isCenter,n=void 0===t||t,a=e.color,r=void 0===a?"dark":a;return o.a.createElement(o.a.Fragment,null,n?o.a.createElement("div",{className:H.a.wrapperCenter},o.a.createElement(D.a,{animation:"border",variant:r,className:H.a.spinner},o.a.createElement("span",{className:"sr-only"},"Loading..."))):o.a.createElement("div",{className:H.a.wrapper},o.a.createElement(D.a,{animation:"border",variant:r,className:H.a.spinner},o.a.createElement("span",{className:"sr-only"},"Loading..."))))},F=n(56),Y=n.n(F),Q=function(){return o.a.createElement("header",null,o.a.createElement("img",{src:Y.a,alt:"\u041b\u043e\u0433\u043e",className:"logo"}),o.a.createElement("span",null,"PicCat"))},W=n(115),X=n(35),Z=n.n(X),$=function(e){var t=e.username,n=e.link,a=e.profileImage;return o.a.createElement("div",{className:Z.a.username},o.a.createElement("a",{href:n,target:"_blank",rel:"noopener noreferrer"},o.a.createElement("img",{src:a,alt:"\u0410\u0432\u0430\u0442\u0430\u0440",className:Z.a.profileImage})),o.a.createElement("a",{href:n,target:"_blank",rel:"noopener noreferrer"},t))};function ee(e){var t=e.substring(0,10).split("-");return"".concat(t[2],".").concat(t[1],".").concat(t[0])}n(106);var te=function(e){var t=e.photo,n=e.location,r=e.likePhoto,c=e.unlikePhoto,l=e.likingInProgress,i=e.history,s=e.getPhoto,u=Object(a.useState)(!1),h=Object(R.a)(u,2),m=h[0],p=h[1],d=Object(a.useState)(!0),f=Object(R.a)(d,2),k=f[0],g=f[1],b=Object(a.useState)(null),E=Object(R.a)(b,2),_=E[0],v=E[1];Object(a.useEffect)((function(){v(n.pathname.split("photos/")[1]),!_||t&&t.id===_||s(_),t&&t.id===_&&(p(!0),w())}),[_,t,s,n]);var w=function(){return g(!0)};return m?o.a.createElement(W.a,{show:k,onHide:function(){g(!1),i.push("/")},size:"lg"},o.a.createElement(W.a.Header,{closeButton:!0},o.a.createElement(W.a.Title,null,o.a.createElement($,{profileImage:t.user.profile_image.medium,username:t.user.username,link:t.user.links.html}))),o.a.createElement(W.a.Body,null,o.a.createElement("img",{src:t.urls.regular,alt:"\u0424\u043e\u0442\u043e",className:"modal-photo"})),o.a.createElement(W.a.Footer,null,o.a.createElement("span",null,ee(t.created_at)),o.a.createElement("div",{className:"likes-wrapper"},o.a.createElement("span",{className:"likes"},t.likes),t.liked_by_user?o.a.createElement("button",{className:"btn-like",disabled:l.some((function(e){return e===_})),onClick:function(){return c(_)}},o.a.createElement("svg",{width:"1.45rem",height:"1.45rem",viewBox:"0 0 16 16",className:"bi bi-suit-heart-fill like-fill",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("path",{d:"M4 1c2.21 0 4 1.755 4 3.92C8 2.755 9.79 1 12 1s4 1.755 4 3.92c0 3.263-3.234 4.414-7.608 9.608a.513.513 0 0 1-.784 0C3.234 9.334 0 8.183 0 4.92 0 2.755 1.79 1 4 1z"}))):o.a.createElement("button",{className:"btn-like",disabled:l.some((function(e){return e===_})),onClick:function(){return r(_)}},o.a.createElement("svg",{width:"1.45rem",height:"1.45rem",viewBox:"0 0 16 16",className:"bi bi-suit-heart like",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("path",{fillRule:"evenodd",d:"M8 6.236l.894-1.789c.222-.443.607-1.08 1.152-1.595C10.582 2.345 11.224 2 12 2c1.676 0 3 1.326 3 2.92 0 1.211-.554 2.066-1.868 3.37-.337.334-.721.695-1.146 1.093C10.878 10.423 9.5 11.717 8 13.447c-1.5-1.73-2.878-3.024-3.986-4.064-.425-.398-.81-.76-1.146-1.093C1.554 6.986 1 6.131 1 4.92 1 3.326 2.324 2 4 2c.776 0 1.418.345 1.954.852.545.515.93 1.152 1.152 1.595L8 6.236zm.392 8.292a.513.513 0 0 1-.784 0c-1.601-1.902-3.05-3.262-4.243-4.381C1.3 8.208 0 6.989 0 4.92 0 2.755 1.79 1 4 1c1.6 0 2.719 1.05 3.404 2.008.26.365.458.716.596.992a7.55 7.55 0 0 1 .596-.992C9.281 2.049 10.4 1 12 1c2.21 0 4 1.755 4 3.92 0 2.069-1.3 3.288-3.365 5.227-1.193 1.12-2.642 2.48-4.243 4.38z"})))))):o.a.createElement(V,{color:"success"})},ne=(n(108),function(e){var t=e.photoId,n=e.url,a=e.date,c=e.likes,l=e.likedByUser,i=e.user,s=e.likePhoto,u=e.unlikePhoto,h=e.likingInProgress;return o.a.createElement("div",{className:"photo-card"},o.a.createElement("div",{className:"photo-header"},o.a.createElement("span",null,ee(a)),o.a.createElement("div",{className:"likes-wrapper"},o.a.createElement("span",{className:"likes"},c),l?o.a.createElement("button",{className:"btn-like",disabled:h.some((function(e){return e===t})),onClick:function(){return u(t)}},o.a.createElement("svg",{width:"1.45rem",height:"1.45rem",viewBox:"0 0 16 16",className:"bi bi-suit-heart-fill like-fill",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("path",{d:"M4 1c2.21 0 4 1.755 4 3.92C8 2.755 9.79 1 12 1s4 1.755 4 3.92c0 3.263-3.234 4.414-7.608 9.608a.513.513 0 0 1-.784 0C3.234 9.334 0 8.183 0 4.92 0 2.755 1.79 1 4 1z"}))):o.a.createElement("button",{className:"btn-like",disabled:h.some((function(e){return e===t})),onClick:function(){return s(t)}},o.a.createElement("svg",{width:"1.45rem",height:"1.45rem",viewBox:"0 0 16 16",className:"bi bi-suit-heart like",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("path",{fillRule:"evenodd",d:"M8 6.236l.894-1.789c.222-.443.607-1.08 1.152-1.595C10.582 2.345 11.224 2 12 2c1.676 0 3 1.326 3 2.92 0 1.211-.554 2.066-1.868 3.37-.337.334-.721.695-1.146 1.093C10.878 10.423 9.5 11.717 8 13.447c-1.5-1.73-2.878-3.024-3.986-4.064-.425-.398-.81-.76-1.146-1.093C1.554 6.986 1 6.131 1 4.92 1 3.326 2.324 2 4 2c.776 0 1.418.345 1.954.852.545.515.93 1.152 1.152 1.595L8 6.236zm.392 8.292a.513.513 0 0 1-.784 0c-1.601-1.902-3.05-3.262-4.243-4.381C1.3 8.208 0 6.989 0 4.92 0 2.755 1.79 1 4 1c1.6 0 2.719 1.05 3.404 2.008.26.365.458.716.596.992a7.55 7.55 0 0 1 .596-.992C9.281 2.049 10.4 1 12 1c2.21 0 4 1.755 4 3.92 0 2.069-1.3 3.288-3.365 5.227-1.193 1.12-2.642 2.48-4.243 4.38z"}))))),o.a.createElement(r.b,{to:"/photos/".concat(t)},o.a.createElement("img",{src:n,alt:"\u0424\u043e\u0442\u043e",className:"photo"})),o.a.createElement("div",{style:{margin:".8rem"}},o.a.createElement($,{profileImage:i.profile_image.medium,username:i.username,link:i.links.html})))}),ae=n(63),oe=function(e){return o.a.createElement("main",null,o.a.createElement("h1",null,"PicCat - \u0444\u043e\u0442\u043e \u043d\u0430 \u043b\u044e\u0431\u043e\u0439 \u0432\u043a\u0443\u0441"),o.a.createElement(ae.a,{dataLength:e.photo.photos.length,next:function(){e.getPhotos(e.photo.photos.length)},hasMore:!0,loader:o.a.createElement(V,{isCenter:!1})},o.a.createElement("div",{className:"masonry-container"},e.photo.photos.map((function(t){return o.a.createElement(ne,{url:t.urls.regular,key:t.id,photoId:t.id,user:t.user,date:t.created_at,likes:t.likes,likedByUser:t.liked_by_user,likePhoto:e.likePhoto,unlikePhoto:e.unlikePhoto,likingInProgress:e.photo.likingInProgress})})))))};n(110);var re=Object(c.d)(K.g,Object(T.b)((function(e){return{auth:e.auth,photo:e.photo}}),{setToken:function(e){return{type:s,token:e}},getPhotos:function(e,t){return function(n){n(N(!0)),b(e,t).then((function(e){n(N(!1)),n({type:w,photos:e})}))}},likePhoto:function(e){return function(t){t(j(!0,e)),_(e).then((function(n){!n.error&&n.photo.id&&t(C(n.photo.id,n.photo.liked_by_user,n.photo.likes)),t(j(!1,e))}))}},unlikePhoto:function(e){return function(t){t(j(!0,e)),v(e).then((function(n){!n.error&&n.photo.id&&t(C(n.photo.id,n.photo.liked_by_user,n.photo.likes)),t(j(!1,e))}))}},getPhoto:function(e){return function(t){t(N(!0)),E(e).then((function(e){t(N(!1)),t({type:O,photo:e})}))}}}))((function(e){var t=Object(a.useState)(!1),n=Object(R.a)(t,2),r=n[0],c=n[1],l=Object(a.useRef)(e);Object(a.useEffect)((function(){l.current=e}));var i=Object(a.useCallback)((function(){var e=JSON.parse(localStorage.getItem("userData"));e&&e.token?(f.auth.setBearerToken(e.token),l.current.setToken(e.token),c(!0)):function(){var e=f.auth.getAuthenticationUrl(["public","write_likes"]);window.location.assign(e)}()}),[]);return Object(a.useEffect)((function(){var e=l.current.location.search.split("code=")[1];e?A(e,l.current.setToken).then((function(e){e?c(!0):i()})):i(),l.current.getPhotos(0)}),[i]),r?o.a.createElement("div",{className:"container"},o.a.createElement(Q,null),o.a.createElement(K.d,null,o.a.createElement(K.b,{path:"/photos/:photoId",exact:!0},o.a.createElement(oe,e),o.a.createElement(te,{location:e.location,history:e.history,likePhoto:e.likePhoto,unlikePhoto:e.unlikePhoto,likingInProgress:e.photo.likingInProgress,photo:e.photo.photoById,getPhoto:e.getPhoto})),o.a.createElement(K.b,{path:"/",exact:!0},o.a.createElement(oe,e)),o.a.createElement(K.a,{to:"/"}))):o.a.createElement(V,null)}));n(111);U.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(r.a,null,o.a.createElement(T.a,{store:B},o.a.createElement(re,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},24:function(e,t,n){e.exports={wrapperCenter:"Preloader_wrapperCenter__1-8U_",wrapper:"Preloader_wrapper__2l7_S",spinner:"Preloader_spinner__3ke5a"}},35:function(e,t,n){e.exports={username:"Username_username__3Mqf7",profileImage:"Username_profileImage__2Vtnu"}},56:function(e,t,n){e.exports=n.p+"static/media/logo.47ab8fcf.png"},65:function(e,t,n){e.exports=n(112)}},[[65,1,2]]]);
//# sourceMappingURL=main.6da16a8e.chunk.js.map